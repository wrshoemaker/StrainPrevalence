

import calculate_predicted_prevalence_mapgd
import numpy

f_max = 1
pi_filter = numpy.asarray([3.12661459e-02, 1.43062991e-03, 7.20068667e-03, 3.00942251e-01,
       5.30496493e-03, 2.52978307e-04, 0.00000000e+00, 1.18372782e-03,
       1.02815387e-03, 6.89878002e-04, 3.41914097e-03, 6.36318120e-03,
       5.03328663e-03, 9.04755663e-04, 0.00000000e+00, 0.00000000e+00,
       0.00000000e+00, 0.00000000e+00, 8.07925653e-04, 1.22285792e-03,
       1.00591990e-02, 4.99246301e-03, 7.65473252e-03, 5.98752878e-03,
       1.77494508e-03, 2.49044422e-03, 8.60895426e-04, 9.90943176e-04,
       1.02500989e-04, 6.65511615e-03, 1.57996381e-04, 1.25042272e-02,
       1.25528304e-03, 9.20005118e-02, 6.09129739e-04, 2.71810215e-03,
       1.48990873e-03, 0.00000000e+00, 1.15331293e-04, 2.90282025e-03,
       2.68922613e-02, 2.18759388e-04])

depths = numpy.asarray([ 23,  56,  58,  25,  21,  26,  29,  96,  31,  22, 195,  23,  26,
        40,  61, 342, 117,  38,  30,  25,  22,  77,  33,  55,  25,  34,
        24,  22,  21,  48,  24,  85,  79,  41,  24,  25,  42,  24,  51,
       108,  21,  49])

f = numpy.asarray([3.12661459e-02, 1.43062991e-03, 7.20068667e-03, 3.00942251e-01,
       5.30496493e-03, 2.52978307e-04, 0.00000000e+00, 1.18372782e-03,
       1.02815387e-03, 6.89878002e-04, 3.41914097e-03, 6.36318120e-03,
       5.03328663e-03, 9.04755663e-04, 0.00000000e+00, 0.00000000e+00,
       0.00000000e+00, 0.00000000e+00, 8.07925653e-04, 1.22285792e-03,
       1.00591990e-02, 4.99246301e-03, 7.65473252e-03, 5.98752878e-03,
       1.77494508e-03, 2.49044422e-03, 8.60895426e-04, 9.90943176e-04,
       1.02500989e-04, 6.65511615e-03, 1.57996381e-04, 1.25042272e-02,
       1.25528304e-03, 9.20005118e-02, 6.09129739e-04, 2.71810215e-03,
       1.48990873e-03, 0.00000000e+00, 1.15331293e-04, 2.90282025e-03,
       2.68922613e-02, 2.18759388e-04])



predicted_prevalence, observed_prevalence = calculate_predicted_prevalence_mapgd.predict_prevalence(f_max, pi_filter, depths,f, min_minor_allele_cov=10)

print(predicted_prevalence, observed_prevalence)
